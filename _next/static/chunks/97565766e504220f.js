(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,44970,e=>{"use strict";var t=e.i(43476),s=e.i(75157);function a({intel:e,layout:a="compact"}){let l=e?.frequency_class??null,r=e?.total_times_on_special??0,i=e?.avg_frequency_days??null,c=!l&&r<=1,n="frequent"===l?3:"sometimes"===l?2:+("rare"===l),o="frequent"===l?"bg-price-down":"sometimes"===l?"bg-brand":"rare"===l?"bg-price-up":"bg-text-tertiary/30",d=c?"Just spotted":"frequent"===l?"On sale often":"sometimes"===l?"Sometimes on sale":"rare"===l?"Rarely on sale":"Just spotted",x=!c&&i?`Every ~${i}d`:c?"No sale history yet":null;return"compact"===a?(0,t.jsxs)("div",{className:"flex items-center gap-1.5 mt-1",children:[(0,t.jsx)("div",{className:"flex items-center gap-[3px]",children:[0,1,2].map(e=>(0,t.jsx)("span",{className:(0,s.cn)("h-[5px] w-[5px] rounded-full transition-colors",e<n?o:"bg-text-tertiary/15 dark:bg-text-tertiary/25")},e))}),(0,t.jsx)("span",{className:(0,s.cn)("text-[10px] font-semibold leading-none","rare"===l?"text-price-up":"frequent"===l?"text-price-down":"sometimes"===l?"text-brand-dark dark:text-brand":"text-text-tertiary"),children:d})]}):(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"flex items-center gap-[3px]",children:[0,1,2].map(e=>(0,t.jsx)("span",{className:(0,s.cn)("h-1.5 w-1.5 rounded-full transition-colors",e<n?o:"bg-text-tertiary/15 dark:bg-text-tertiary/25")},e))}),(0,t.jsx)("span",{className:(0,s.cn)("text-[11px] font-semibold","rare"===l?"text-price-up":"frequent"===l?"text-price-down":"sometimes"===l?"text-brand-dark dark:text-brand":"text-text-tertiary"),children:d}),x&&(0,t.jsx)("span",{className:"text-[11px] text-text-tertiary",children:x})]})}e.s(["SaleSignal",()=>a])},43531,e=>{"use strict";let t=(0,e.i(75254).default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],43531)},24879,e=>{"use strict";var t=e.i(43476);let s=(0,e.i(75254).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var a=e.i(43531),l=e.i(75157),r=e.i(61225),i=e.i(44970);function c({special:e,intel:c,size:n="default"}){let{hasItem:o,toggleItem:d}=(0,r.useWatchlist)(),x=o(e.store,e.product_id),m=e.discount_pct&&e.discount_pct>=48,p=e.original_price&&e.current_price?(e.original_price-e.current_price).toFixed(2):null;return(0,t.jsxs)("div",{className:(0,l.cn)("relative bg-surface-raised rounded-2xl overflow-hidden","border border-separator/60","transition-transform active:scale-[0.97]","carousel"===n?"w-[156px]":"w-full"),children:[(0,t.jsx)("div",{className:"absolute top-2 left-2 z-10 flex flex-col gap-1",children:m?(0,t.jsx)("span",{className:"badge-half-price",children:"Â½ PRICE"}):e.discount_pct?(0,t.jsxs)("span",{className:"badge-save",children:[e.discount_pct,"% OFF"]}):null}),(0,t.jsx)("button",{onClick:t=>{t.stopPropagation(),d({store:e.store,productId:e.product_id,name:e.name})},className:(0,l.cn)("absolute top-2 right-2 z-10 p-1.5 rounded-full transition-all","shadow-sm",x?"bg-brand text-white":"bg-white/90 dark:bg-surface-secondary/90 text-text-secondary backdrop-blur-sm"),"aria-label":x?"Remove from list":"Add to list",children:x?(0,t.jsx)(a.Check,{size:14,strokeWidth:3}):(0,t.jsx)(s,{size:14,strokeWidth:2.5})}),(0,t.jsx)("div",{className:"flex items-center justify-center bg-white dark:bg-surface-secondary pt-3 pb-1 px-3",children:e.image_url?(0,t.jsx)("img",{src:e.image_url,alt:e.name,className:"h-[100px] w-[100px] object-contain mix-blend-multiply",loading:"lazy"}):(0,t.jsx)("div",{className:"h-[100px] w-[100px] flex items-center justify-center text-text-tertiary text-2xl font-medium",children:e.name.charAt(0)})}),(0,t.jsxs)("div",{className:"px-2.5 pb-2.5 pt-1.5",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1 mb-0.5",children:[(0,t.jsx)("span",{className:(0,l.cn)("h-1.5 w-1.5 rounded-full","woolworths"===e.store?"bg-woolworths":"bg-coles")}),(0,t.jsx)("span",{className:"text-[10px] text-text-tertiary font-medium uppercase tracking-wide",children:"woolworths"===e.store?"Woolworths":"Coles"})]}),(0,t.jsx)("p",{className:"text-[13px] font-medium leading-tight text-text-primary line-clamp-2 min-h-[32px]",children:e.name}),(0,t.jsxs)("div",{className:"mt-1.5 flex items-baseline gap-1.5",children:[(0,t.jsx)("span",{className:"text-[18px] font-bold tabular-nums leading-none",children:(0,l.formatPrice)(e.current_price)}),e.original_price&&(0,t.jsx)("span",{className:"text-[12px] text-text-tertiary line-through tabular-nums",children:(0,l.formatPrice)(e.original_price)})]}),p&&(0,t.jsxs)("p",{className:"text-[11px] font-semibold text-price-down mt-0.5",children:["Save $",p]}),(0,t.jsx)(i.SaleSignal,{intel:c,layout:"compact"})]})]})}e.s(["ProductTile",()=>c],24879)},15624,e=>{"use strict";var t=e.i(43476),s=e.i(71645),a=e.i(75254);let l=(0,a.default)("flame",[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]]),r=(0,a.default)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),i=(0,a.default)("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);var c=e.i(75157);function n({label:e,isActive:s,onClick:a}){return(0,t.jsx)("button",{onClick:a,className:(0,c.cn)("whitespace-nowrap rounded-full px-4 py-2 text-sm font-medium transition-all",s?"bg-text-primary text-surface shadow-sm":"bg-surface-secondary text-text-secondary"),children:e})}var o=e.i(24879),d=e.i(7471);function x(){let[e,a]=(0,s.useState)([]),[x,m]=(0,s.useState)([]),[p,u]=(0,s.useState)([]),[h,f]=(0,s.useState)("All"),[g,b]=(0,s.useState)("all"),[j,y]=(0,s.useState)(!0),[N,v]=(0,s.useState)(30);(0,s.useEffect)(()=>{!async function(){let[{data:e},{data:t}]=await Promise.all([d.supabase.from("specials").select("*").not("discount_pct","is",null).order("discount_pct",{ascending:!1}),d.supabase.from("special_intel").select("*")]);a(e??[]),m(t??[]),u([...new Set((e??[]).map(e=>e.category).filter(Boolean))].sort()),y(!1)}()},[]),(0,s.useEffect)(()=>{v(30)},[h,g]);let w=(e,t)=>x.find(s=>s.store===e&&s.product_id===t)??null,k=(0,s.useMemo)(()=>e.filter(e=>("all"===g||e.store===g)&&("All"===h||e.category===h)),[e,g,h]),_=k.slice(0,8),S=k.filter(e=>w(e.store,e.product_id)?.frequency_class==="rare").slice(0,8),A=k.slice(0,N),C=N<k.length;return j?(0,t.jsx)("div",{className:"mx-auto max-w-lg px-4 pt-safe",children:(0,t.jsxs)("div",{className:"pt-14 space-y-4",children:[(0,t.jsx)("div",{className:"skeleton h-10 w-1/3"}),(0,t.jsx)("div",{className:"flex gap-2",children:[1,2,3,4].map(e=>(0,t.jsx)("div",{className:"skeleton h-8 w-20 rounded-full"},e))}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-3",children:[1,2,3,4].map(e=>(0,t.jsx)("div",{className:"skeleton h-[220px] rounded-2xl"},e))})]})}):(0,t.jsxs)("div",{className:"mx-auto max-w-lg pt-safe pb-safe",children:[(0,t.jsxs)("header",{className:"pt-14 pb-2 px-4",children:[(0,t.jsx)("h1",{className:"text-[34px] font-bold leading-tight tracking-tight",children:"Specials"}),(0,t.jsxs)("p",{className:"text-sm text-text-secondary mt-0.5",children:[e.length.toLocaleString()," deals this week"]})]}),(0,t.jsx)("div",{className:"flex gap-2 mt-2 mb-3 px-4",children:["all","woolworths","coles"].map(e=>(0,t.jsx)("button",{onClick:()=>b(e),className:(0,c.cn)("px-3 py-1.5 rounded-full text-sm font-medium transition-colors",g===e?"bg-text-primary text-surface":"bg-surface-secondary text-text-secondary"),children:"all"===e?"All Stores":"woolworths"===e?"Woolworths":"Coles"},e))}),(0,t.jsxs)("div",{className:"flex gap-2 overflow-x-auto pb-2 px-4 no-scrollbar",children:[(0,t.jsx)(n,{label:"All",isActive:"All"===h,onClick:()=>f("All")}),p.map(e=>(0,t.jsx)(n,{label:e,isActive:h===e,onClick:()=>f(e)},e))]}),"All"===h&&_.length>0&&(0,t.jsxs)("section",{className:"mt-5",children:[(0,t.jsx)("div",{className:"flex items-center justify-between px-4 mb-2",children:(0,t.jsxs)("h2",{className:"text-[17px] font-bold flex items-center gap-1.5",children:[(0,t.jsx)(l,{size:18,className:"text-price-up"}),"Biggest Discounts"]})}),(0,t.jsx)("div",{className:"carousel",children:_.map(e=>(0,t.jsx)(o.ProductTile,{special:e,intel:w(e.store,e.product_id),size:"carousel"},e.id))})]}),"All"===h&&S.length>0&&(0,t.jsxs)("section",{className:"mt-6",children:[(0,t.jsx)("div",{className:"flex items-center justify-between px-4 mb-2",children:(0,t.jsxs)("h2",{className:"text-[17px] font-bold flex items-center gap-1.5",children:[(0,t.jsx)(r,{size:18,className:"text-brand"}),"Rare Finds"]})}),(0,t.jsx)("p",{className:"text-[12px] text-text-tertiary px-4 -mt-1 mb-2",children:"Items that rarely go on special"}),(0,t.jsx)("div",{className:"carousel",children:S.map(e=>(0,t.jsx)(o.ProductTile,{special:e,intel:w(e.store,e.product_id),size:"carousel"},e.id))})]}),(0,t.jsxs)("section",{className:"mt-6 mb-20 px-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("h2",{className:"text-[17px] font-bold flex items-center gap-1.5",children:[(0,t.jsx)(i,{size:16,className:"text-text-secondary"}),"All"===h?"All Specials":h]}),(0,t.jsxs)("span",{className:"text-[13px] text-text-tertiary tabular-nums",children:[k.length.toLocaleString()," items"]})]}),k.length>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"grid grid-cols-2 gap-3",children:A.map(e=>(0,t.jsx)(o.ProductTile,{special:e,intel:w(e.store,e.product_id)},e.id))}),C&&(0,t.jsxs)("button",{onClick:()=>v(e=>e+30),className:(0,c.cn)("w-full mt-4 py-3 rounded-xl text-sm font-medium","bg-surface-secondary text-text-secondary","transition-colors active:bg-separator"),children:["Show more (",(k.length-N).toLocaleString()," remaining)"]})]}):(0,t.jsx)("p",{className:"py-12 text-center text-text-tertiary text-sm",children:"No specials match your filters"})]})]})}e.s(["default",()=>x],15624)}]);